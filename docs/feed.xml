<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://bridgetownrb.com/" version="0.20.0">Bridgetown</generator><link href="https://mariochavez.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://mariochavez.io/" rel="alternate" type="text/html" /><updated>2021-12-27T22:34:09-06:00</updated><id>https://mariochavez.io/feed.xml</id><title type="html">Mario Alberto Chávez Cárdenas</title><subtitle>Blog sobre temas de desarrollo de software Web con Ruby y Ruby on Rails, además de temas de fotografía análoga y digital.</subtitle><author><name>Mario Alberto Chávez Cárdenas</name></author><entry xml:lang="es_MX"><title type="html">Solitude</title><link href="https://mariochavez.io/proyectos/2021/09/28/solitude/" rel="alternate" type="text/html" title="Solitude" /><published>2021-09-28T02:00:00-05:00</published><updated>2021-09-28T02:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/09/28/solitude</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/09/28/solitude/">&lt;div class=&quot; prose md:prose-lg&quot;&gt;
&lt;p&gt;
La soledad mejor asociada con una condición psicológica causada por la ausencia de otros seres humanos.
Para algunas personas esta condición les permite dirigir su vida con autonomia e inclusive puede ser una
herramienta para los procesos creativos del individuo.
&lt;/p&gt;

&lt;p&gt;
En otros seres humanos esta condición detona una respuesta emocional negativa que puede llevar a
la. depresión con consecuencias fatales.
&lt;/p&gt;

&lt;p&gt;
Quizás esta condición es la más presente y con la que nos podemos relacionar casi al instante al
escuchar la palabra soledad. Sin embargo, la soledad no necesariamente implica la ausencia de otros
seres, también puede existir a partir de la inexistencia de artefactos humanos en nuestro alrededor.
Es precisamente a esta última interpretación en la que está basada la serie fotográfica de la muestra.
A esa soledad buscada conscientemente en done la existencia de lo humano y sus artefactos (casi)
desaparecen de nuestro alrededor, dejándonos únicamente con la soledad de nuestra existencia con
el entorno que nos rodea.
&lt;/p&gt;

&lt;p&gt;
Esta soledad es una forma de escapar del ruido de los ciudades, del ruido de nuestras mentes para
explorar estos paisajes que bajo otras condiciones pueden pasar desapercibidos, encontrar una
conexión con el mundo natural y valorar estos elementos de los cuales no tenemos control pero sin
embargo somos parte de ellos.
&lt;/p&gt;
&lt;/div&gt;

&lt;div class=&quot;mt-6&quot;&gt;
  &lt;h3 class=&quot;font-semibold text-lg mb-4&quot;&gt;Solitude I&lt;/h3&gt;

  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-2.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-3.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div&gt;
      &lt;div class=&quot;aspect-w-2 aspect-h-3&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-4.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude II&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-5.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-6.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-7.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude III&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-8.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-9.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-10.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude IV&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-11.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-12.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-13.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude V&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-14.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-2 aspect-h-3&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-15.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-16.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude VI&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-17.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-18.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-19.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude VII&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-20.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-21.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-2 aspect-h-3&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-22.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude VIII&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-23.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-2 aspect-h-3&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-24.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-25.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude IX&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-26.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-27.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-28.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude X&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-29.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-30.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-2 aspect-h-3&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-31.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude XI&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-32.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-33.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-2 aspect-h-3&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-34.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3 class=&quot;font-semibold text-lg mt-4 mb-4&quot;&gt;Solitude XII&lt;/h3&gt;
  &lt;div class=&quot;grid grid-cols-1 gap-4 md:grid-cols-2&quot;&gt;
    &lt;div class=&quot;md:col-span-2&quot;&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-35.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-36.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;div class=&quot;aspect-w-3 aspect-h-2&quot;&gt;
        &lt;img src=&quot;/images/solitude/Solitude-37.jpg&quot; loading=&quot;lazy&quot; class=&quot;w-full h-full object-center object-cover lg:w-full lg:h-full&quot; /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">La soledad mejor asociada con una condición psicológica causada por la ausencia de otros seres humanos. Para algunas personas esta condición les permite dirigir su vida con autonomia e inclusive puede ser una herramienta para los procesos creativos del individuo.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/solitude/Solitude-1.jpg" /><media:content medium="image" url="https://mariochavez.io/images/solitude/Solitude-1.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="en_MX"><title type="html">La Cofradía de los volcanes</title><link href="https://mariochavez.io/proyectos/2021/08/31/la-cofradia-de-los-volcanes/" rel="alternate" type="text/html" title="La Cofradía de los volcanes" /><published>2021-08-31T13:00:00-05:00</published><updated>2021-08-31T13:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/08/31/la-cofradia-de-los-volcanes</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/08/31/la-cofradia-de-los-volcanes/">&lt;p&gt;La Cofradía de los Volcanes es un trabajo sobre la exploración del territorio que circunda los Volcanes de Fuego y Nevado de Colima.&lt;/p&gt;

&lt;div class=&quot;book&quot; data-controller=&quot;book&quot;&gt;
  &lt;div class=&quot;book-wrapper&quot; data-book-target=&quot;wrapper&quot;&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/00.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/01.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/02.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/03.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/04.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/05.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/06.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/07.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/08.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/09.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/10.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/11.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/12.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/13.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/14.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/15.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/16.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/17.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/18.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/19.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/20.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/21.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/22.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/23.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/24.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/25.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/26.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/27.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/cofradia_libro/28.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&quot;paginator&quot; data-book-target=&quot;paginator&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p class=&quot;font-sans text-xs font-semibold text-center text-gray-600&quot;&gt;Utilice las flechas del teclado para cambiar página&lt;p&gt;
&lt;/p&gt;&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">La Cofradía de los Volcanes es un trabajo sobre la exploración del territorio que circunda los Volcanes de Fuego y Nevado de Colima.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/cofradia_libro/04.jpg" /><media:content medium="image" url="https://mariochavez.io/images/cofradia_libro/04.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="en_US"><title type="html">Slow landscapes</title><link href="https://mariochavez.io/proyectos/2021/08/09/slow-landscapes/" rel="alternate" type="text/html" title="Slow landscapes" /><published>2021-08-09T13:00:00-05:00</published><updated>2021-08-09T13:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/08/09/slow-landscapes</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/08/09/slow-landscapes/">&lt;p&gt;Slow landscape is a still going project that captures nature landscapes wiht slow shutter speed and camera motion to create these dynamic, texture, and colorful landscape images that take us into a unreal place.&lt;/p&gt;

&lt;div class=&quot;gallery&quot;&gt;
  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape10.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Black sand&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;
  
  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape1.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;By the beach I&lt;/figcaption&gt;
    &lt;/figure&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape2.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;By the beach II&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;

  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape3.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;By the beach III&lt;/figcaption&gt;
    &lt;/figure&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape4.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;By the beach IV&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;

  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape5.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Pasture land&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;

  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape6.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Vegetation I&lt;/figcaption&gt;
    &lt;/figure&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape7.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Vegetation II&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;

  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape8.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Vegetation III&lt;/figcaption&gt;
    &lt;/figure&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape9.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Vegetation IV&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;

  &lt;div class=&quot;gallery-2&quot;&gt;
    &lt;figure&gt;
      &lt;img src=&quot;/images/slow_landscapes/slow-landscape11.jpg&quot; loading=&quot;lazy&quot; /&gt;
      &lt;figcaption&gt;Sunset&lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/div&gt;
&lt;/div&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">Slow landscape is a still going project that captures nature landscapes wiht slow shutter speed and camera motion to create these dynamic, texture, and colorful landscape images that take us into a unreal place.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/slow_landscapes/slow-landscape1.jpg" /><media:content medium="image" url="https://mariochavez.io/images/slow_landscapes/slow-landscape1.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="es_MX"><title type="html">Libro “El color del olvido”</title><link href="https://mariochavez.io/proyectos/2021/07/08/libro-el-color-del-olvido/" rel="alternate" type="text/html" title="Libro “El color del olvido”" /><published>2021-07-08T13:00:00-05:00</published><updated>2021-07-08T13:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/07/08/libro-el-color-del-olvido</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/07/08/libro-el-color-del-olvido/">&lt;p&gt;Este libro es el resultado del taller Nuevo reportaje del fotógrafo Ricardo Cases.&lt;/p&gt;

&lt;h3 id=&quot;libro-el-color-del-olvido&quot;&gt;Libro “El color del olvido”&lt;/h3&gt;
&lt;div class=&quot;book&quot; data-controller=&quot;book&quot;&gt;
  &lt;div class=&quot;book-wrapper&quot; data-book-target=&quot;wrapper&quot;&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/00.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/01.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/02.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/03.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/04.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/05.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/06.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/07.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/08.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/09.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/10.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/11.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/12.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/13.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/14.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/15.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/16.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/17.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/18.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/color/19.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&quot;paginator&quot; data-book-target=&quot;paginator&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p class=&quot;font-sans text-xs font-semibold text-center text-gray-600&quot;&gt;Utilice las flechas del teclado para cambiar página&lt;p&gt;
&lt;/p&gt;&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">Este libro es el resultado del taller Nuevo reportaje del fotógrafo Ricardo Cases.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/color/color.jpg" /><media:content medium="image" url="https://mariochavez.io/images/color/color.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="es_MX"><title type="html">Libro “Embeleso del vértice”</title><link href="https://mariochavez.io/proyectos/2021/07/05/libro-el-embeleso-del-vertice/" rel="alternate" type="text/html" title="Libro “Embeleso del vértice”" /><published>2021-07-05T13:00:00-05:00</published><updated>2021-07-05T13:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/07/05/libro-el-embeleso-del-vertice</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/07/05/libro-el-embeleso-del-vertice/">&lt;p&gt;Este libro es el resultado del taller de Conceptualización Visual con el artista visual español Manuel Moranta.&lt;/p&gt;

&lt;h3 id=&quot;libro-el-embeleso-del-vértice&quot;&gt;Libro “El embeleso del vértice”&lt;/h3&gt;
&lt;div class=&quot;book&quot; data-controller=&quot;book&quot;&gt;
  &lt;div class=&quot;book-wrapper&quot; data-book-target=&quot;wrapper&quot;&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/00.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/01.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/02.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/03.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/04.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/05.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/06.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/07.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/08.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/09.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/embeleso/10.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&quot;paginator&quot; data-book-target=&quot;paginator&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p class=&quot;font-sans text-xs font-semibold text-center text-gray-600&quot;&gt;Utilice las flechas del teclado para cambiar página&lt;p&gt;
&lt;/p&gt;&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">Este libro es el resultado del taller de Conceptualización Visual con el artista visual español Manuel Moranta.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/embeleso/embeleso.jpg" /><media:content medium="image" url="https://mariochavez.io/images/embeleso/embeleso.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="es_MX"><title type="html">Libro “Una mirada desde el cielo”</title><link href="https://mariochavez.io/proyectos/2021/07/05/libro-una-mirada-desde-el-cielo/" rel="alternate" type="text/html" title="Libro “Una mirada desde el cielo”" /><published>2021-07-05T12:00:00-05:00</published><updated>2021-07-05T12:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/07/05/libro-una-mirada-desde-el-cielo</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/07/05/libro-una-mirada-desde-el-cielo/">&lt;p&gt;La fotografía de dron permite tener una perspectiva poco usual del lugar donde vivimos. Este libro trata precisamente de ofrecer esa perspectiva única de los 10 municipios de Estado de Colima.&lt;/p&gt;

&lt;p&gt;Este libro representa el recorrido por cerca de tres años de visitar los municipios en diferentes épocas del año.&lt;/p&gt;

&lt;h3 id=&quot;libro-una-mirada-desde-el-cielo&quot;&gt;Libro “Una mirada desde el cielo”&lt;/h3&gt;
&lt;div class=&quot;book&quot; data-controller=&quot;book&quot;&gt;
  &lt;div class=&quot;book-wrapper&quot; data-book-target=&quot;wrapper&quot;&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/00.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/01.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/02.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/03.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/04.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/05.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/06.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/07.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/08.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/09.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/10.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/11.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/12.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/13.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/14.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/15.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/16.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/17.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/18.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/19.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/20.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/21.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/22.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/23.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/24.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/25.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/26.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/27.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/28.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/29.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/30.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/31.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/32.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/33.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/34.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/35.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/36.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/37.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/38.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/39.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/40.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/41.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/42.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/43.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/44.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/45.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/46.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/47.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/48.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/49.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/50.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/51.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/52.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/53.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/54.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/55.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/56.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/57.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/58.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/59.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/60.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/61.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/62.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/63.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/64.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/65.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/66.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/67.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/68.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/69.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/70.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/71.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/72.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/73.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/74.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/75.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/mirada/76.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; style=&quot;height: 70%; margin: auto;&quot; /&gt;
      &lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&quot;paginator&quot; data-book-target=&quot;paginator&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p class=&quot;font-sans text-xs font-semibold text-center text-gray-600&quot;&gt;Utilice las flechas del teclado para cambiar página&lt;p&gt;
&lt;/p&gt;&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">La fotografía de dron permite tener una perspectiva poco usual del lugar donde vivimos. Este libro trata precisamente de ofrecer esa perspectiva única de los 10 municipios de Estado de Colima.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/mirada/una-mirada.jpg" /><media:content medium="image" url="https://mariochavez.io/images/mirada/una-mirada.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="es_MX"><title type="html">Libro “Los Chayacates de Ixtlahuacán, Una historia de tradición y devoción”</title><link href="https://mariochavez.io/proyectos/2021/07/04/libro-de-los-chayacates/" rel="alternate" type="text/html" title="Libro “Los Chayacates de Ixtlahuacán, Una historia de tradición y devoción”" /><published>2021-07-04T13:00:00-05:00</published><updated>2021-07-04T13:00:00-05:00</updated><id>https://mariochavez.io/proyectos/2021/07/04/libro-de-los-chayacates</id><content type="html" xml:base="https://mariochavez.io/proyectos/2021/07/04/libro-de-los-chayacates/">&lt;p&gt;La fiesta popular de “Los Chayacates de Ixtlahuacán” sucede cada 5 y 6 de Enero en la cabecera municipal de Ixtlahuacán de los Reyes Colima.&lt;/p&gt;

&lt;p&gt;El fervor de los habiatntes del pueblo, las manifestaciones de color, participación, unión y amistad celebran el evento de Epifanía con devoción y respecto, combinando las creencias religiosas con pinceladas de ritos prehispánicos.&lt;/p&gt;

&lt;p&gt;Los Chayacates, son cuatro personajes indígenas ataviados con máscaras blancas de madera de colorín, trenzas de fibra de acapán y vestuario de ixtle. Estos personajes, al igual que los Reyes Magos, se enteran del nacimiento de Jesus en Belén y son guiados por el olfato de sus perros  hasta él.&lt;/p&gt;

&lt;p&gt;La fiesta alcanza a todo el pueblo con la típica pastorela y el recorrido y danzas de los cuatro Chayacates quienes van preguntando en náhuatl “Campa mutla catiles, endios sipilzin” por el niño Dios.&lt;/p&gt;

&lt;h3 id=&quot;libro-los-chayacates-de-ixtlahuacán-una-historia-de-tradición-y-devoción&quot;&gt;Libro “Los Chayacates de Ixtlahuacán, Una historia de tradición y devoción”&lt;/h3&gt;
&lt;div class=&quot;book&quot; data-controller=&quot;book&quot;&gt;
  &lt;div class=&quot;book-wrapper&quot; data-book-target=&quot;wrapper&quot;&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/00.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/01.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/02.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/03.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/04.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/05.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/06.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/07.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/08.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/09.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/10.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/11.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/12.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/13.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/14.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/15.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/16.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/17.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/18.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/19.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/20.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/21.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
      
      &lt;div class=&quot;section&quot; data-book-target=&quot;page&quot;&gt;
        &lt;img src=&quot;/images/chayacates_libro/22.jpg&quot; loading=&quot;lazy&quot; class=&quot;page&quot; /&gt;
      &lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&quot;paginator&quot; data-book-target=&quot;paginator&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p class=&quot;font-sans text-xs font-semibold text-center text-gray-600&quot;&gt;Utilice las flechas del teclado para cambiar página&lt;p&gt;
&lt;/p&gt;&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">La fiesta popular de “Los Chayacates de Ixtlahuacán” sucede cada 5 y 6 de Enero en la cabecera municipal de Ixtlahuacán de los Reyes Colima.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/foto_libro/IMG_6268.jpg" /><media:content medium="image" url="https://mariochavez.io/images/foto_libro/IMG_6268.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">HEIC support for Active Storage</title><link href="https://mariochavez.io/desarrollo/2021/06/22/heic-support-active-storage/" rel="alternate" type="text/html" title="HEIC support for Active Storage" /><published>2021-06-22T02:00:00-05:00</published><updated>2021-06-22T02:00:00-05:00</updated><id>https://mariochavez.io/desarrollo/2021/06/22/heic-support-active-storage</id><content type="html" xml:base="https://mariochavez.io/desarrollo/2021/06/22/heic-support-active-storage/">&lt;p&gt;Active Storage is the Ruby on Rails solution to work with file attachments on an application. It is not the only solution available, but it comes by default as part of the framework, so there is a chance that it is used on new projects.&lt;/p&gt;

&lt;p&gt;Working with images is as easy as possible; creating variants to display images in different sizes might be the most common use case in a Rails Application. The &lt;a href=&quot;https://github.com/janko/image_processing&quot; target=&quot;_blank&quot;&gt;image_processing&lt;/a&gt; gem is responsible for abstracting the complexity of creating an image variant, like resizing the image to be 300px on the longest side.&lt;/p&gt;

&lt;p&gt;Underneath the image_processing gem, it uses &lt;a href=&quot;https://imagemagick.org/script/index.php&quot; target=&quot;_blank&quot;&gt;ImageMagick&lt;/a&gt; or &lt;a href=&quot;https://libvips.github.io/libvips/&quot; target=&quot;_blank&quot;&gt;Vips&lt;/a&gt; to handle image operations and transformations; by default, it uses the first, ImageMagick..&lt;/p&gt;

&lt;h2 id=&quot;heif-and-heic-image-formats&quot;&gt;HEIF and HEIC image formats.&lt;/h2&gt;

&lt;p&gt;High Efficiency Image File format or HEIF is a container for images and videos that requires half of the storage as JPEG with the same image quality. The HEIC format, which is a variation of HIEF and stands for High Efficiency Image Container, was introduced by Apple with the release of iOS 11 and macOS High Sierra The format is not widely adopted. For example, no browser can display a HEIC image, and only a few Android devices support it.to optimize the space of Apple’s devices.&lt;/p&gt;

&lt;p&gt;The format is not widely adopted. For example, no browser can display a HEIC image, and only a few Android devices support it.&lt;/p&gt;

&lt;p&gt;There is a &lt;a href=&quot;https://www.theverge.com/2020/5/20/21262302/ap-test-fail-iphone-photos-glitch-email-college-board-jpeg-heic&quot; target=&quot;_blank&quot;&gt;case where High School students failed a test&lt;/a&gt; because their school systems didn’t support the HEIC format.&lt;/p&gt;

&lt;h2 id=&quot;add-active-storage-support-for-heic&quot;&gt;Add Active Storage support for HEIC.&lt;/h2&gt;

&lt;p&gt;At &lt;a href=&quot;https://creditar.io&quot; target=&quot;_blank&quot;&gt;Creditar.io&lt;/a&gt;, we are working on a service that allows customers to upload a photo of a Mexican ID, then the service validates the ID extracts its information. Everything was fine until we received our first HEIC file; our service could not do anything with the file.&lt;/p&gt;

&lt;p&gt;A quick &lt;a href=&quot;https://duckduckgo.com/&quot; target=&quot;_blank&quot;&gt;DuckDuckGo&lt;/a&gt; search about this told me what I already knew, no support out of the box for HEIC on Active Storage. Some work needs to be done to enable it. I came across this post, “&lt;a href=&quot;https://hashtagjohnt.com/how-to-generage-heic-previews-in-rails-using-activestorage.html&quot; target=&quot;_blank&quot;&gt;How to generate HEIC previews in Rails using ActiveStorage&lt;/a&gt;”.&lt;/p&gt;

&lt;p&gt;The post explains how to create an Active Storage Previewer that converts a HEIC image into a PNG or any other format. It uses Vips as image processing library and describes how to enable Vips support on Heroku.&lt;/p&gt;

&lt;p&gt;ImageMagick is used at &lt;a href=&quot;https://creditar.io&quot; target=&quot;_blank&quot;&gt;Creditar.io&lt;/a&gt;, and I didn’t want to switch to Vips. With the latest versions of ImageMagick, it can be compiled with HEIC support. If you are on macOS and use Homebrew to install dependencies, version 7.x comes with support for HEIC.&lt;/p&gt;

&lt;p&gt;The changes in the previewer to work with ImageMagick are very simple.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# app/previewers/heic_previewer.rb&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HeicPreviewer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveStorage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Previewer&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;CONTENT_TYPE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;image/heic&quot;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;accept?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;content_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;CONTENT_TYPE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;minimagick_exists?&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;minimagick_exists?&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@minimagick_exists&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@minimagick_exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;blank?&lt;/span&gt;

      &lt;span class=&quot;vi&quot;&gt;@minimagick_exists&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;defined?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ImageProcessing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MiniMagick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; :: MiniMagick is not installed&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@minimagick_exists&lt;/span&gt;

      &lt;span class=&quot;vi&quot;&gt;@minimagick_exists&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;preview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transformations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;download_blob_to_tempfile&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;io&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ImageProcessing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MiniMagick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;io: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;filename: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;content_type: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image/png&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The previewer needs to be registered with Active Storage via an initializer.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# config/initializers/active_storage.rb&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;active_storage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;previewers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;HeicPreviewer&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;active_storage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;variable_content_types&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;image/heic&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;active_storage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;variable_content_types&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;image/heif&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And we must tell Active Storage that HEIC/HEIF content types are supported. The test for this previewer is as follows.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# test/previewers/heic_previewer_test.rb&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;test_helper&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HeicPreviewerTest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveStorageBlob&lt;/span&gt;

  &lt;span class=&quot;no&quot;&gt;CONTENT_TYPE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;image/heic&quot;&lt;/span&gt;

  &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;it previews a heic image&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;it does not run on CI due to missing support for HEIC&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;CI&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;true&quot;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;create_file_blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;filename: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;heic-image-file.heic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;content_type: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;CONTENT_TYPE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;refute_nil&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;HeicPreviewer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;accept?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;no&quot;&gt;HeicPreviewer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;preview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({})&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attachable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;assert_equal&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;image/png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attachable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;create_file_blog&lt;/code&gt; method is a helper that I use to create an Active Storage blob object from a file. The test is simple; it tests that previewing or downloading a file get converted to PNG.&lt;/p&gt;

&lt;p&gt;Running this test on GitHub’s CI was impossible because the ImageMagick version it provides comes without HEIC support. I tried to download and compile ImageMagick in the pipeline, but it takes too much time, so I decided to skip this test there. It works on my machine(tm), so what can go wrong, right?&lt;/p&gt;

&lt;p&gt;To deploy these changes, Heroku needs a buildpack with an ImageMagick binary compiled with HEIC. There are a few of those in Heroku’s marketplace, so I settle for &lt;a href=&quot;https://elements.heroku.com/buildpacks/himamainc/heroku-buildpack-imagemagick-heif&quot; target=&quot;_blank&quot;&gt;this one&lt;/a&gt;. It needs to be installed before deploying the code changes. Installation is simple.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;heroku&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buildpacks&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:add&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;HiMamaInc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heroku&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buildpack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imagemagick&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;github&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;com&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;HiMamaInc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heroku&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buildpack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imagemagick&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After these changes in the code, customers can take a picture with their iPhone and send it to our service to validate their ID, no need to worry if they had HEIC enable on their phones. The service displays the thumbnail and sends a png version to the Python ML backend to be processed.&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">Active Storage is the Ruby on Rails solution to work with file attachments on an application. It is not the only solution available, but it comes by default as part of the framework, so there is a chance that it is used on new projects.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/heic/iphone.jpg" /><media:content medium="image" url="https://mariochavez.io/images/heic/iphone.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="es_MX"><title type="html">Actualizar Ruby on Rails con boot doble</title><link href="https://mariochavez.io/desarrollo/2020/08/04/actualizar-ruby-on-rails-con-dual-boot/" rel="alternate" type="text/html" title="Actualizar Ruby on Rails con boot doble" /><published>2020-08-04T02:00:00-05:00</published><updated>2020-08-04T02:00:00-05:00</updated><id>https://mariochavez.io/desarrollo/2020/08/04/actualizar-ruby-on-rails-con-dual-boot</id><content type="html" xml:base="https://mariochavez.io/desarrollo/2020/08/04/actualizar-ruby-on-rails-con-dual-boot/">&lt;p&gt;Desde la versión 4.2 de Ruby on Rails las actualizaciones del framework son en buena medida estables. Atendiendo cuestiones de API’s que ya están fuera de uso, verificando que las gemas o dependencias de la aplicación tengan ya soporte de la versión a la que vamos actualizar y que contenemos con un set de pruebas por lo menos es la funcionalidad crítica es suficiente para tener éxito.&lt;/p&gt;

&lt;p&gt;Obviamente el tiempo y esfuerzo de actualización también dependerá de que tan grande es nuestra aplicación y la cantidad de ajustes que se requieran. Este esfuerzo se puede ver afectado en buena medida cuando tratamos de realizar la actualización en un “&lt;em&gt;branch&lt;/em&gt;” de git con los nuevo cambios y que de alguna forma se empiece a quedar atrás esa rama de los cambios principales.&lt;/p&gt;

&lt;p&gt;En este post voy a resumir la estrategia que desde mi punto de vista es la más efectiva.&lt;/p&gt;

&lt;h2 id=&quot;dualboot&quot;&gt;Dualboot&lt;/h2&gt;

&lt;p&gt;Normalmente soy de los desarrolladores que que prefieren omitir el uso de gemas o librería a menos  de que sea realmente necesario. &lt;a href=&quot;https://github.com/Shopify/bootboot&quot; target=&quot;_blank&quot;&gt;Bootboot&lt;/a&gt; de Shopify en esta caso es bastante útil ya que permite tener dos &lt;code class=&quot;highlighter-rouge&quot;&gt;Gemfile&lt;/code&gt; uno que es el base de la aplicación y otro dónde se tiene la versión de Rails a la que vamos actualizar así como versiones de dependencias necesarias.&lt;/p&gt;

&lt;p&gt;Con una variable de ambiente es posible hacer que la aplicación haga el boot con la versión actual de Rails o con la versión nueva. Esto permite mandar a la rama principal los cambios de la actualización y los cambios normales de aplicación evitando conflictos a la larga o tener una rama de actualización separada por varias semanas y cuando estamos listos resolver conflictos.&lt;/p&gt;

&lt;p&gt;Bootboot se instala como un plugin de Bundler en el archivo &lt;code class=&quot;highlighter-rouge&quot;&gt;Gemfile&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;plugin &lt;span class=&quot;s1&quot;&gt;&apos;bootboot&apos;&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;&apos;~&amp;gt; 0.1.1&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Después de agregar la librería ejecutamos lo siguiente.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;bundle &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; bundle bootboot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Al finalizer Bundler vamos a tener un archivo &lt;code class=&quot;highlighter-rouge&quot;&gt;Gemfile_next.lock&lt;/code&gt; y en el archivo &lt;code class=&quot;highlighter-rouge&quot;&gt;Gemfile&lt;/code&gt; vamos a encontrar un bloque que nos permite con la variable de ambiente &lt;em&gt;DEPENDENCIES_NEXT&lt;/em&gt; hacer el boot de la aplicación con una versión de Rail u otra.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;ENV[&lt;span class=&quot;s2&quot;&gt;&quot;DEPENDENCIES_NEXT&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  enable_dual_booting &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;Plugin.installed?&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;bootboot&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Add any gem you want here, they will be loaded only when running&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# bundler command prefixed with `DEPENDENCIES_NEXT=1`.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
&lt;/span&gt;end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;El &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; yo lo modifiqué para quedara de la siguiente forma.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;ENV.fetch&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DEPENDENCIES_NEXT&quot;&lt;/span&gt;, 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.to_i &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; 1
  enable_dual_booting &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;Plugin.installed?&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;bootboot&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Add any gem you want here, they will be loaded only when running&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# bundler command prefixed with `DEPENDENCIES_NEXT=1`.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
&lt;/span&gt;end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Como primer paso es agregar en el bloque del &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; las dependencias de la versión a la cuál queremos migrar. Para el proyecto que utilicé para este ejemplo estoy migrando de Rails 6.0 a master de Rails que está marcado como Rails 6.1.alpha.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;ENV.fetch&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DEPENDENCIES_NEXT&quot;&lt;/span&gt;, 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.to_i &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; 1
  enable_dual_booting &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;Plugin.installed?&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;bootboot&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c&quot;&gt;# Add any gem you want here, they will be loaded only when running&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# bundler command prefixed with `DEPENDENCIES_NEXT=1`.&lt;/span&gt;
  gem &lt;span class=&quot;s2&quot;&gt;&quot;rails&quot;&lt;/span&gt;, github: &lt;span class=&quot;s2&quot;&gt;&quot;rails/rails&quot;&lt;/span&gt;
  gem &lt;span class=&quot;s2&quot;&gt;&quot;puma&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;~&amp;gt; 5.0.0.beta1&quot;&lt;/span&gt;
  gem &lt;span class=&quot;s2&quot;&gt;&quot;webpacker&quot;&lt;/span&gt;, github: &lt;span class=&quot;s2&quot;&gt;&quot;rails/webpacker&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;gem &lt;span class=&quot;s2&quot;&gt;&quot;puma&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;~&amp;gt; 3.11&quot;&lt;/span&gt;
  gem &lt;span class=&quot;s2&quot;&gt;&quot;rails&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;~&amp;gt; 6.0.0&quot;&lt;/span&gt;
  gem &lt;span class=&quot;s2&quot;&gt;&quot;webpacker&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;~&amp;gt; 4.0&quot;&lt;/span&gt;
end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Primeramente agregué la referencia de Rails a Github y corrí Bundler con la variable de ambiente.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ DEPENDENCIES_NEXT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 bundle &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Bundler me indicó que tenía conflictos para instalar Webpacker 4.0 con Rails 6.1.alpha entonces agregué Rails y Webpacker actual al bloque del &lt;code class=&quot;highlighter-rouge&quot;&gt;else&lt;/code&gt; y agregué Webpacker de Github al bloque del &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Este proceso lo repetí varias ocasiones hasta que en cada uno de los bloques del &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; tuviera las dependencias correctas. Este es el primer paso.&lt;/p&gt;

&lt;h2 id=&quot;configuración-de-la-aplicación&quot;&gt;Configuración de la aplicación&lt;/h2&gt;

&lt;p&gt;El siguiente paso es hacer que la aplicación pueda finalmente hacer el boot. Ejecuté el servidor de Rails de la siguiente forma.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ DEPENDENCIES_NEXT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1  bin/rails s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hubo código en los inicializadores que impedían que el servidor se iniciara correctamente pero es código que en la versión actual de Rails de la aplicación funciona sin problemas.&lt;/p&gt;

&lt;p&gt;En este punto necesito tener información de qué versión de Rails se está ejecutando para decidir que código cambia, se queda o se modifica pero siempre manteniendo compatibilidad entre ambas versiones.&lt;/p&gt;

&lt;p&gt;Modifiqué el archivo &lt;code class=&quot;highlighter-rouge&quot;&gt;config/application.rb&lt;/code&gt; donde agregué el siguiente método.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rails_6_0?&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Gem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;VERSION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Este método está disponible vía &lt;code class=&quot;highlighter-rouge&quot;&gt;Rails.application.rails_6_0?&lt;/code&gt; y me permite conocer si estoy en la versión actual de la aplicación o en la versión nueva para de esta forma ejecutar cierto código para cada versión.&lt;/p&gt;

&lt;p&gt;Es necesario hacer los ajustes que nuestra aplicación nos vaya solicitando para asegurar que al menos podemos hacer el boot de la misma.&lt;/p&gt;

&lt;p&gt;Como siempre en cada actualización es necesario ejecutar el comando &lt;code class=&quot;highlighter-rouge&quot;&gt;bin/rails app:update&lt;/code&gt;. Este proceso va a actualizar los archivos de configuración de la aplicación de forma interactiva, es decir, nos va a preguntar que acción realizar. Para cada archivo mostrado normalmente en mi caso o hago que sobre escriba el archivo con &lt;strong&gt;&lt;em&gt;Y&lt;/em&gt;&lt;/strong&gt; o que me muestre las diferencias de los cambios propuestos con &lt;strong&gt;&lt;em&gt;d&lt;/em&gt;&lt;/strong&gt; o negarle el que haga cambios con &lt;strong&gt;&lt;em&gt;n&lt;/em&gt;&lt;/strong&gt;. La decisión va a depender de cada aplicación.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;bin/rails app:update
    conflict  config/boot.rb
Overwrite /Users/marioch/Development/michelada/butaca/config/boot.rb? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;enter &lt;span class=&quot;s2&quot;&gt;&quot;h&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Ynaqdhm]
        Y - &lt;span class=&quot;nb&quot;&gt;yes&lt;/span&gt;, overwrite
        n - no, &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not overwrite
        a - all, overwrite this and all others
        q - quit, abort
        d - diff, show the differences between the old and the new
        h - &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt;, show this &lt;span class=&quot;nb&quot;&gt;help
        &lt;/span&gt;m - merge, run merge tool
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Para el caso de actualización posiblemente en los archivos de configuración vamos a querer mantener la configuración actual y si hay cambios debido a la nueva versión de Rails entonces vamos a tener que hacer uso de nuestro método &lt;code class=&quot;highlighter-rouge&quot;&gt;Rails.application.rails_6_0?&lt;/code&gt; para mantener ambas configuraciones separadas.&lt;/p&gt;

&lt;h2 id=&quot;ajustes-a-la-aplicación&quot;&gt;Ajustes a la aplicación&lt;/h2&gt;

&lt;p&gt;En este punto podemos ejecutar la suite de pruebas y comenzar a corregir cualquier problema descubierto. Con la ayuda del equipo de QA también podemos descubrir ajustes necesarios. Recuerda que debido al &lt;strong&gt;&lt;em&gt;dual boot&lt;/em&gt;&lt;/strong&gt; podemos enviar de forma segura esos cambios a la rama principal de nuestro repositorio.&lt;/p&gt;

&lt;p&gt;En el momento que nos sentimos satisfechos de los cambios realizados y que estamos listos para enviar nuestra aplicación con la nueva versión de Rails a producción y que confirmamos que funciona como lo esperamos, es momento de eliminar cualquier código condicional que agregamos durante el proceso de actualización.&lt;/p&gt;

&lt;h2 id=&quot;conclusiones&quot;&gt;Conclusiones&lt;/h2&gt;

&lt;p&gt;Realmente no hay excusa para no tratar de actualizar nuestras aplicaciones a las nuevas versiones de Ruby on Rails y de Ruby. Las versiones recientes son bastante estables y la compatibilidad se ha mantenido para muchos de los casos.&lt;/p&gt;

&lt;p&gt;Empresas como Github, Shopify y Basecamp al día de hoy corren con las versiones más nuevas sin problemas. Inclusive en el caso de Basecamp indican que tienen varios meses corriendo con la rama principal de Rails.&lt;/p&gt;

&lt;p&gt;Es necesario perder el miedo a actualizar y obtener los beneficios de seguridad y rendimiento de las versiones más recientes.&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">Desde la versión 4.2 de Ruby on Rails las actualizaciones del framework son en buena medida estables. Atendiendo cuestiones de API’s que ya están fuera de uso, verificando que las gemas o dependencias de la aplicación tengan ya soporte de la versión a la que vamos actualizar y que contenemos con un set de pruebas por lo menos es la funcionalidad crítica es suficiente para tener éxito.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/boot/upgrade-rails.jpg" /><media:content medium="image" url="https://mariochavez.io/images/boot/upgrade-rails.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="es_MX"><title type="html">Autenticación Two-Factor (2FA)</title><link href="https://mariochavez.io/desarrollo/2020/07/13/autenticacion-two-factor-2fa/" rel="alternate" type="text/html" title="Autenticación Two-Factor (2FA)" /><published>2020-07-13T01:01:00-05:00</published><updated>2020-07-13T01:01:00-05:00</updated><id>https://mariochavez.io/desarrollo/2020/07/13/autenticacion-two-factor-2fa</id><content type="html" xml:base="https://mariochavez.io/desarrollo/2020/07/13/autenticacion-two-factor-2fa/">&lt;h1 id=&quot;autenticación-two-factor-2fa&quot;&gt;Autenticación Two-Factor (2FA)&lt;/h1&gt;

&lt;p&gt;El publicar una aplicación en Internet automáticamente vuelve la cuestión de seguridad un tema importante como el agregar nuevas características o solucionar errores en la misma.&lt;/p&gt;

&lt;p&gt;Aunque Ruby on Rails  por omisión configura toda nueva aplicación con ciertos parámetros que básicos de seguridad hay detalles que nosotros como desarrolladores o administradores de una aplicación debemos de tomar.&lt;/p&gt;

&lt;p&gt;El el post de hace unas semanas &lt;a href=&quot;https://mariochavez.io/desarrollo/2020/06/15/seguridad-ruby-aplicacion.html&quot; target=&quot;_blank&quot;&gt;Proteger tu aplicación de ataques en Internet&lt;/a&gt; platiqué de acciones que podemos configurar para proteger una aplicación de posibles ataques, el la mayoría automatizados.&lt;/p&gt;

&lt;p&gt;Ahora en este post quiero hablar de el tema de cómo proteger a nuestros usuarios del robo de contraseñas o de un tipo de ataque llamado &lt;em&gt;phising&lt;/em&gt; diseñado con la misma idea de robar credenciales.&lt;/p&gt;

&lt;h2 id=&quot;two-factor-2fa-contraseñas-de-un-sólo-uso&quot;&gt;Two-Factor (2FA) contraseñas de un sólo uso&lt;/h2&gt;

&lt;p&gt;En muchas de las aplicaciones modernas que se preocupan por la seguridad de sus usuarios agregan un nivel más a la protección de contraseñas. Aplicaciones de correo electrónico, de información financiera o bancos entre muchas otras cuentan como una opción más de protección las contraseñas de un sólo uso.&lt;/p&gt;

&lt;p&gt;Este tipo de seguridad se conoce como autenticación &lt;em&gt;Two-Factor&lt;/em&gt; e implica que el usuario aparte de su contraseña para iniciar una sesión necesita generar un código temporal de un sólo uso con una aplicación de su teléfono. La aplicación registra un código secreto que utiliza para generar los códigos temporales que el usuario necesita.&lt;/p&gt;

&lt;p&gt;Aplicaciones como Google Authenticator o &lt;a href=&quot;https://authy.com/&quot; target=&quot;_blank&quot;&gt;Authy&lt;/a&gt; se utilizan para generar ese código temporal.&lt;/p&gt;

&lt;p&gt;Otra forma de implementar las contraseñas de un sólo uso es con el envío del código temporal a través de SMS al teléfono del usuario como segundo paso después de introducir su contraseña.&lt;/p&gt;

&lt;h2 id=&quot;rails-y-otp&quot;&gt;Rails y OTP&lt;/h2&gt;

&lt;p&gt;Implementar OTP en una aplicación de Ruby on Rails es relativamente sencillo gracias a la gema &lt;a href=&quot;https://github.com/mdp/rotp&quot; target=&quot;_blank&quot;&gt;rtop&lt;/a&gt; que hace todo el trabajo de implementar los &lt;a href=&quot;http://tools.ietf.org/html/rfc4226&quot; target=&quot;_blank&quot;&gt;RFC 4226&lt;/a&gt; y &lt;a href=&quot;http://tools.ietf.org/html/rfc6238&quot; target=&quot;_blank&quot;&gt;RFC 6238&lt;/a&gt; para contraseñas de un sólo uso por contador o por tiempo.&lt;/p&gt;

&lt;p&gt;Realmente utilizando &lt;em&gt;rtop&lt;/em&gt; lo complicado es diseñar un flujo que sea amigable para el usuario no técnico dónde se le lleve por el proceso de activar su cuenta para que este protegida por 2FA. Además, hay que darle la posibilidad al usuario de poder tener acceso a la misma en caso de que su dispositivo móvil se haya dañado o extraviado; esto generalmente sucede con un grupo de códigos de recuperación que el usuario recibe al momento de activar su cuenta para 2FA.&lt;/p&gt;

&lt;h3 id=&quot;la-aplicación&quot;&gt;La aplicación&lt;/h3&gt;

&lt;p&gt;Para el contenido de este post cree una aplicación de Ruby on Rails con la implementación de OTP y sus flujos. Donde la lógica de controladores y vistas están dentro de un &lt;em&gt;namespace&lt;/em&gt; llamado &lt;strong&gt;&lt;em&gt;Otp&lt;/em&gt;&lt;/strong&gt; con la finalidad de que sea sencilla su reutilización en otras aplicaciones.&lt;/p&gt;

&lt;p&gt;Para el sistema de autenticación vía correo electrónico y contraseña no utilicé ninguna de las librerías populares, en su lugar utilicé un generador que desarrollé hace algunos años y que genera lo básico para poder registrarse e iniciar y cerrar sesión utilizando la funcionalidad de &lt;a href=&quot;http://api.rubyonrails.org/classes/ActiveModel/SecurePassword/ClassMethods.html#method-i-has_secure_password&quot; target=&quot;_blank&quot;&gt;has_secure_password&lt;/a&gt; de Rails. El motivo de esta decisión es eliminar la complejidad de las librerías conocidas del foco de la implementación de OTP. El código del generador está disponible en su &lt;a href=&quot;https://github.com/mariochavez/mac_generators/&quot; target=&quot;_blank&quot;&gt;repositorio&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;El repositorio del código de esta aplicación está disponible en el &lt;a href=&quot;https://github.com/mariochavez/rails-two-factor-otp&quot; target=&quot;_blank&quot;&gt;repositorio&lt;/a&gt;. El post no va a mostrar en detalle el código por lo que va a ser necesario hacer referencia en el repositorio.&lt;/p&gt;

&lt;p&gt;La aplicación de Rails de creó como se muestra a continuación. Se desactivaron algunos &lt;em&gt;frameworks&lt;/em&gt; de Ruby on Rails que no son útiles para los objetivos de esta aplicación. Adicionalmente se instaló Webpack y Stimulus, siendo el último utilizado en varias partes de la aplicación que veremos un poco más adelante.&lt;/p&gt;

&lt;p&gt;Finalmente con el generador que mencioné anteriormente generamos modelos, vistas y controladores para poder realizar registro y autenticación vía correo electrónico. Por omisión en lugar de crear el modelo &lt;strong&gt;&lt;em&gt;User&lt;/em&gt;&lt;/strong&gt;, al que estamos acostumbrados, se crea el modelo &lt;strong&gt;&lt;em&gt;Identity&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rail&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otp_security&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;postgresql&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mailer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mailbox&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;active&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;skip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sprockets&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otp_security&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rails&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;webpacker&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:install&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rails&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;webpacker&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:install:stimulus&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yarn&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bulma&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rails&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;authentication&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;activar-2fa&quot;&gt;Activar 2FA&lt;/h3&gt;

&lt;p&gt;Activar 2FA para un usuario implica el explicarle al usuario en qué consiste y cómo va a cambiar su experiencia al iniciar sesión y llevarlo de la mano en el proceso.&lt;/p&gt;

&lt;p&gt;El proceso tipo “&lt;em&gt;wizard&lt;/em&gt;” se inicia con el controlador &lt;code class=&quot;highlighter-rouge&quot;&gt;Otp::ConfigureController&lt;/code&gt; en donde inicialmente con la ayuda de &lt;em&gt;rtop&lt;/em&gt; se genera un código secreto y único por cada usuario.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@otp_secret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generate_otp_secret&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@qr_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generate_qr_code_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;vi&quot;&gt;@otp_secret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;El “&lt;em&gt;wizard&lt;/em&gt;” informativo es manejado por el controlador de Stimulus &lt;code class=&quot;highlighter-rouge&quot;&gt;wizard_controller.js&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Controller&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;stimulus&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Controller&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;targets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;slide&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showSlide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;disconnect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showSlide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stopPropagation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;preventDefault&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showSlide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;back&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stopPropagation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;preventDefault&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;showSlide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;showSlide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;slideTargets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;data-wizard-index&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;classList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toggle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;wizard--current&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Al final del “&lt;em&gt;wizard&lt;/em&gt;” al usuario se le presenta un código QR que debe de escanear utilizando una aplicación de autenticación 2FA compatible con Google Authenticator como &lt;a href=&quot;https://authy.com/&quot; target=&quot;_blank&quot;&gt;Authy&lt;/a&gt;. Después de escanear y registrar la autenticación en la aplicación móvil el usuario tiene que introducir el código generado para verificar que todo se encuentra listo para habilitar 2FA para el usuario.&lt;/p&gt;

&lt;p&gt;El código del usuario se recibe en el controlador &lt;code class=&quot;highlighter-rouge&quot;&gt;Otp::ConfigureController&lt;/code&gt; donde una vez que ha sido verificado se guarda el secreto único del usuario, se guarda el &lt;em&gt;timestamp&lt;/em&gt; del último código que verificó el usuario y se generan 10 código de recuperación en caso de el usuario pierda o se le dañe su dispositivo y que no quede bloqueado.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;otp_secret&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:otp_secret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;otp_code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:otp_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;last_otp_at&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verify_otp_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otp_secret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otp_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_otp_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@recovery_codes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generate_recovery_codes&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tap&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_otp_at&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_otp_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;utc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_datetime&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;otp_secret_key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otp_secret&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;recovery_codes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@recovery_codes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;save&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otp_complete_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;notice: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2AF enabled succesfully&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;json: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;error: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Verification code is invalid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;status: :unprocessable_entity&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;El código único y secreto así como los código de recuperación son secretos sensibles de los cuales tenemos que prevenir que caigan en manos no confiables. Es por este motivo que esos atributos se guardan cifrados en la base de datos con la ayuda de la gema &lt;a href=&quot;https://github.com/attr-encrypted/attr_encrypted&quot; target=&quot;_blank&quot;&gt;attr_encrypted&lt;/a&gt;. La llave de cifrado se guarda en las credenciales de Rails.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Identity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_secure_password&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;validations: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;attr_encrypted&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:otp_secret_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:recovery_codes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;key: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;decode64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;credentials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;encryption&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:otp_secret_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;validates&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;presence: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;uniqueness: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;validates&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:password_confirmation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;presence: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;if: &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La llave de cifrado se genera en una consola de Ruby con el siguiente comando &lt;code class=&quot;highlighter-rouge&quot;&gt;Base64.encode64(SecureRandom.random_bytes(32))&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Una vez que se validó el código y se guardó la información secreta, al usuario se le muestran sus códigos de recuperación, los cuales van a ser visibles esta única ocasión y se le muestra al usuario opciones para copiar los códigos al “&lt;em&gt;clipboard&lt;/em&gt;” o imprimirlos o descargarlos en un archivo. Es responsabilidad del usuario guardarlo y mantenerlos seguros. El controlador &lt;code class=&quot;highlighter-rouge&quot;&gt;Otp::CompleteController&lt;/code&gt; se encarga de esta parte.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;show&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;update_column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:otp_enabled_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;zone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;vi&quot;&gt;@recovery_codes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;recovery_codes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La lógica para copiar, imprimir o descargar los códigos de recuperación está implementada en los controladores de Stimulus &lt;code class=&quot;highlighter-rouge&quot;&gt;clipboard_controller.js&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;print_controller.js&lt;/code&gt; y &lt;code class=&quot;highlighter-rouge&quot;&gt;download_controller.js&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;gallery&quot;&gt;
  &lt;figure&gt;
    &lt;img src=&quot;/images/autenticacion/login-with-otp.gif&quot; loading=&quot;lazy&quot; /&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;h3 id=&quot;nuevo-inicio-de-sesión&quot;&gt;Nuevo inicio de sesión&lt;/h3&gt;

&lt;p&gt;Con 2FA activado para un usuario su flujo de inicio de sesión cambia. Ahora el usuario después de ingresar sus credenciales, se le pedirá que ingrese el código temporal que se genera en su aplicación de autenticación en el móvil.&lt;/p&gt;

&lt;p&gt;El código se valida y si es correcto entonces se guarda la última ocasión que el usuario validó un código correcto, esto con el fin de evitar que el código se pueda reutilizar en la ventana de 30 segundos que es cuando se genera un nuevo código.&lt;/p&gt;

&lt;p&gt;Si el código no es válido, entonces el usuario no va a poder iniciar sesión.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;strip&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;verified&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;present_code?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;last_otp_at&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verify_otp_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;otp_secret_key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_otp_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_otp_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;last_otp_at: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_otp_at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;utc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;verified&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;verified_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recovery_codes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verify_recovery_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;recovery_codes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verified_code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;present?&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;recovery_codes: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recovery_codes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;verified&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verified&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;warden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;otp_verified&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;notice: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.logged_in&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;json: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;error: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Verification code is invalid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;status: :unprocessable_entity&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En caso de que el usuario haya perdido acceso a la aplicación móvil que genera los códigos temporales este puede hacer uso de uno de los 10 códigos de recuperación en lugar del código temporal. Al hacer uso del código de recuperación y que sea válido, este se elimina impidiendo que se pueda volver a utilizar y se le permite el inicio de sesión al usuario.&lt;/p&gt;

&lt;p&gt;Esta código se encuentra en el controlador &lt;code class=&quot;highlighter-rouge&quot;&gt;Otp::VerifyController&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;gallery&quot;&gt;
  &lt;figure&gt;
    &lt;img src=&quot;/images/autenticacion/login-with-recovery-code.gif&quot; loading=&quot;lazy&quot; /&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;h3 id=&quot;deshabilitar-2fa&quot;&gt;Deshabilitar 2FA&lt;/h3&gt;

&lt;p&gt;Aunque no es lo recomendable, el usuario que ha iniciado puede deshabilitar la necesidad de autenticación 2FA al iniciar sesión. Esto puede ser necesario en el caso de que el usuario cambie de dispositivo móvil por lo que es necesario deshabilitar 2FA y volver a habilitarlo con el nuevo dispositivo.&lt;/p&gt;

&lt;p&gt;En el controlador &lt;code class=&quot;highlighter-rouge&quot;&gt;Otp::DisableController&lt;/code&gt; se realiza la desactivación de 2FA dónde se elimina la información como secretos, códigos de recuperación y otros datos adicionales que en conjunto deshabilitan 2FA.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;destroy&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;current_identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tap&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last_otp_at&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;otp_secret_key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;recovery_codes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;otp_enabled_at&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;identity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;save&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;redirect_to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;notice: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2FA disabled succesfully&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;gallery&quot;&gt;
  &lt;figure&gt;
    &lt;img src=&quot;/images/autenticacion/disable-otp.gif&quot; loading=&quot;lazy&quot; /&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;h3 id=&quot;detalles-finales-de-la-aplicación&quot;&gt;Detalles finales de la aplicación&lt;/h3&gt;

&lt;p&gt;El módulo &lt;code class=&quot;highlighter-rouge&quot;&gt;Otp::Base&lt;/code&gt; incluye la lógica común entre los controladores relacionados en el proceso de 2FA.&lt;/p&gt;

&lt;p&gt;En el proyecto disponible en el repositorio mencionado al inicio del post se incluyen también algunas pruebas de sistema, es decir pruebas dónde se automatiza el navegador para simular la interacción del usuario. Las pruebas tienen comentarios que explican qué operaciones son las que se están realizando para verificar los escenarios de 2FA.&lt;/p&gt;

&lt;h2 id=&quot;conclusiones&quot;&gt;Conclusiones&lt;/h2&gt;

&lt;p&gt;La seguridad es un factor importante en toda aplicación hoy en día, es algo que como desarrolladores de aplicaciones no debemos de dejar a la ligera. Es nuestra responsabilidad asegurar la información y la confianza de nuestros usuarios.&lt;/p&gt;

&lt;p&gt;Estoy seguro que al revisar a detalle el código de la aplicación de ejemplo veremos que es sencillo implementar un nivel más de seguridad en nuestras aplicaciones y que el código está pensado en que pueda ser reutilizado.&lt;/p&gt;</content><author><name>Mario Alberto Chávez Cárdenas</name></author><summary type="html">Autenticación Two-Factor (2FA)</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://mariochavez.io/images/autenticacion/password-security.jpg" /><media:content medium="image" url="https://mariochavez.io/images/autenticacion/password-security.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>