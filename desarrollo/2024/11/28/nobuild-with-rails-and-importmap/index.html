<!doctype html>
<html lang="en" class="h-full antialiased">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Begin Bridgetown SEO tag v7.0.1 -->
<title>Nobuild with Rails and Importmap | Mario Alberto Chávez - Ruby on Rails, AI Tools &amp; former CTO</title>
<meta property="og:title" content="Nobuild with Rails and Importmap" />
<meta name="author" content="Mario Alberto Chávez" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn how to use Importmap in Ruby on Rails to manage JavaScript dependencies without bundling. Covers web standards, Rails integration, gems compatibility, and suggested practices." />
<meta property="og:description" content="Learn how to use Importmap in Ruby on Rails to manage JavaScript dependencies without bundling. Covers web standards, Rails integration, gems compatibility, and suggested practices." />
<link rel="canonical" href="https://mariochavez.io/desarrollo/2024/11/28/nobuild-with-rails-and-importmap/" />
<meta property="og:url" content="https://mariochavez.io/desarrollo/2024/11/28/nobuild-with-rails-and-importmap/" />
<meta property="og:site_name" content="Mario Alberto Chávez - Ruby on Rails, AI Tools &amp; former CTO" />
<meta property="og:image" content="https://mariochavez.io/images/no-build-importmap/nobuild-with-rails.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-11-28T12:00:00-06:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://mariochavez.io/images/no-build-importmap/nobuild-with-rails.jpg" />
<meta property="twitter:title" content="Nobuild with Rails and Importmap" />
<meta name="twitter:site" content="@mario_chavez" />
<meta name="twitter:creator" content="@Mario Alberto Chávez" />
<!-- End Bridgetown SEO tag -->


<link type="application/atom+xml" rel="alternate" href="https://mariochavez.io/feed.xml" title="Mario Alberto Chávez - Ruby on Rails, AI Tools & former CTO" />

<meta property="og:type" content="article">
<meta property="og:site_name" content="Mario Alberto Chávez - Software Development">
<meta name="twitter:card" content="summary_large_image">

<meta name="robots" content="index, follow">
<meta name="revisit-after" content="7 days">

<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="/assets/index.R2XT6LUA.css" />
<script src="/assets/index.OQDTOKYE.js" defer></script>


<script type="application/javascript">
  (function() {
    try {
      const theme = localStorage.getItem('theme');
      if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    } catch (e) {
      // Fail silently
    }
  })();
</script>

<script type="application/ld+json">
  {
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mariochavez.io/desarrollo/2024/11/28/nobuild-with-rails-and-importmap"
  },
  "headline": "Nobuild with Rails and Importmap",
  "description": "Learn how to use Importmap in Ruby on Rails to manage JavaScript dependencies without bundling. Covers web standards, Rails integration, gems compatibility, and suggested practices.",
  "author": {
    "@type": "Person",
    "name": "Mario Alberto Chávez Cárdenas"
  },
  "datePublished": "2024-11-28",
  "publisher": {
    "@type": "Organization",
    "name": "Mario Alberto Chávez Cárdenas",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mariochavez.io/logo.png"
    }
  },
  "articleBody": "The latest versions of Ruby on Rails have focused on simplicity across different aspects of the framework, accompanied by the promise to return to the 'one-man framework' (where a single developer can effectively build and maintain an entire application). .",
  "keywords": [
    "Ruby on Rails",
    "Importmap",
    "JavaScript",
    "ES modules",
    "NoBuild",
    "Propshaft",
    "Web development"
  ],
  "articleSection": "Desarrollo",
  "inLanguage": "en-US",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://mariochavez.io/images/no-build-importmap/nobuild-with-rails.jpg",
      "width": 1200,
      "height": 630,
      "caption": "Importmap in Ruby on Rails"
    },
    {
      "@type": "ImageObject", 
      "url": "https://mariochavez.io/images/no-build-importmap/heroimage-home.png",
      "width": 800,
      "height": 450,
      "caption": "heroImage website example"
    },
    {
      "@type": "ImageObject",
      "url": "https://mariochavez.io/images/no-build-importmap/tools.png", 
      "width": 800,
      "height": 450,
      "caption": "Web developer tools showing HTTP/2 performance"
    }
  ]
}

</script>

  </head>

  <body class="flex h-full flex-col bg-zinc-50 font-manrope dark:bg-black">
    <!-- Outer Frame for the "Card" look on large screens -->
    <div class="fixed inset-0 flex justify-center sm:px-8">
      <div class="flex w-full max-w-7xl lg:px-8">
        <div
          class="
            w-full bg-white ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-300/20
          "
        ></div>
      </div>
    </div>

    <div class="relative flex w-full flex-col">
      <!-- Header / Navigation -->
<header
  data-controller="menu"
  data-menu-open-value=false
  class="pointer-events-none relative z-50 flex flex-none flex-col"
>
  <div class="top-0 z-10 h-16 pt-6">
    <div class="sm:px-8 w-full max-w-7xl mx-auto lg:px-8">
      <div class="relative px-4 sm:px-8 lg:px-12">
        <div class="mx-auto max-w-2xl lg:max-w-5xl">
          <div class="relative flex gap-4">
            <!-- Logo / Avatar -->
            <div class="flex flex-1 pointer-events-auto">
              <a
                href="/"
                class="
                  h-10 w-10 rounded-full bg-white/90 p-0.5 shadow-lg shadow-zinc-800/5 ring-1
                  ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:ring-white/10
                "
              >
                <img
                  src="/images/mario.jpg"
                  alt="Mario Alberto Chávez"
                  class="
                    h-9 w-9 rounded-full bg-zinc-100 object-cover
                    dark:bg-zinc-800
                  "
                >
              </a>
            </div>

            <!-- Desktop Nav -->
            <div class="hidden md:flex flex-1 justify-center pointer-events-auto">
              <nav
                class="
                  flex rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg
                  shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90
                  dark:text-zinc-200 dark:ring-white/10
                "
              >
               
                  <a
                      href="/about"
                    class="
                      relative block px-3 py-2 transition hover:text-emerald-500
                      dark:hover:text-emerald-400
                    "
                  >
                  About
                  </a>
                
                  <a
                      href="/articles"
                    class="
                      relative block px-3 py-2 transition hover:text-emerald-500
                      dark:hover:text-emerald-400
                    "
                  >
                  Articles
                  </a>
                
                  <a
                      href="/projects"
                    class="
                      relative block px-3 py-2 transition hover:text-emerald-500
                      dark:hover:text-emerald-400
                    "
                  >
                  Projects
                  </a>
                
              </nav>
            </div>

            <!-- Mobile Menu Button & Theme Toggle -->
            <div class="flex flex-1 justify-end gap-4 pointer-events-auto">
              <!-- Mobile Menu Button -->
              <div class="pointer-events-auto md:hidden">
                <button
                  data-action="menu#toggle"
                  class="
                    group flex items-center rounded-full bg-white/90 px-4 py-2 text-sm font-medium
                    text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur
                    dark:bg-zinc-800/90 dark:text-zinc-200 dark:ring-white/10
                    dark:hover:ring-white/20
                  "
                >
                  Menu
                  <i
                    class="
                      ml-3 h-auto w-2 [&_svg]:size-3 stroke-zinc-500 group-hover:stroke-zinc-700
                      dark:group-hover:stroke-zinc-400
                    "
                    
                  ><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
</i>
                </button>
              </div>

              <div 
                data-menu-target="overlay"
                data-action="click->menu#toggle"
                class="
                  data-[open=false]:hidden fixed inset-0 z-50 bg-zinc-800/40 backdrop-blur-xs duration-150 
                  opacity-100 data-[open=false]:opacity-0 ease-in dark:bg-black/80
                " 
                aria-hidden="true" 
                data-open="false">
              </div>

              <!-- Theme Toggle (Visual Only) -->
              <button
                  data-controller="theme"
                  data-theme-dark-value
                  data-action="theme#toggle"
                  class="
                    group rounded-full bg-white/90 px-3 py-2 shadow-lg ring-1 shadow-zinc-800/5 ring-zinc-900/5 
                    backdrop-blur-sm transition dark:bg-zinc-800/90 dark:ring-white/10 dark:hover:ring-white/20
                  "
              >
                <i
                  data-theme-target="light"
                  class="
                    [&_svg]:size-5 text-zinc-500 transition group-hover:fill-zinc-200
                    group-hover:text-zinc-700 dark:hidden
                  "
                  ><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
</i>

                <i
                  data-theme-target="dark"
                  class="
                    hidden [&_svg]:size-5 text-emerald-700 transition dark:block
                    dark:group-hover:text-emerald-400
                  "
                  ><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
</i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Dropdown -->
  <div
    data-menu-target="menu"
    data-open="false"
    class="
      data-[open=false]:hidden opacity-100 data-[open=false]:opacity-0 data-[open=false]:scale-95 
      fixed inset-x-0 top-0 z-50 origin-top rounded-b-2xl bg-zinc-50 px-6 pb-6 pt-24
      shadow-2xl shadow-zinc-900/20 ring-1 ring-zinc-900/5 dark:bg-zinc-900 transition-all ease-out
      dark:ring-zinc-800 pointer-events-auto md:hidden duration-150
    "
  >
    <div class="flex flex-col space-y-4">
      <div class="flex flex-row-reverse items-center justify-between">
        <button 
           data-action="menu#toggle"
           aria-label="Close menu" 
           class="-m-1 p-1 [&_svg]:size-6 text-zinc-500 dark:text-zinc-400" 
           type="button">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="m17.25 6.75-10.5 10.5M6.75 6.75l10.5 10.5" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
 
        </button>
        <h2 class="text-sm font-medium text-zinc-600 dark:text-zinc-400">Navigation</h2>
      </div>
      
        <a
            href="/about"
          class="block text-base font-semibold text-zinc-800 dark:text-zinc-100"
        >
          About
        </a>
      
        <a
            href="/articles"
          class="block text-base font-semibold text-zinc-800 dark:text-zinc-100"
        >
          Articles
        </a>
      
        <a
            href="/projects"
          class="block text-base font-semibold text-zinc-800 dark:text-zinc-100"
        >
          Projects
        </a>
      
    </div>
  </div>
</header>


      <main class="flex-auto pointer-events-auto">
  <div class="mt-16 sm:px-8 sm:mt-32">
    <div class="mx-auto w-full max-w-7xl lg:px-8">
      <div class="relative px-4 sm:px-8 lg:px-12">
        <div class="mx-auto max-w-2xl lg:max-w-5xl">
          <div class="xl:relative">
            <div class="mx-auto max-w-2xl">
              <!-- Back Button -->
              <a
                href="/articles"
                aria-label="Go back to articles"
                class="
                  group mb-8 flex h-10 w-10 items-center justify-center rounded-full bg-white
                  shadow-md shadow-zinc-800/5 ring-1 ring-zinc-900/5 transition dark:border
                  dark:border-zinc-700/50 dark:bg-zinc-800 dark:ring-0 dark:ring-white/10
                  dark:hover:border-zinc-700 dark:hover:ring-white/20 lg:absolute lg:-left-5
                  lg:-mt-2 lg:mb-0 xl:-top-1.5 xl:left-0 xl:mt-0
                "
              >
                <i
                  class="
                    [&_svg]:size-4 text-zinc-500 transition group-hover:text-zinc-700
                    dark:text-zinc-400 dark:group-hover:text-zinc-300
                  "
                  ><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
</i>
              </a>

              <article>
                <header class="flex flex-col">
                  <time
                      datetime="2024-11-28 12:00:00 -0600"
                    class="
                      order-first flex items-center text-base text-zinc-400
                      dark:text-zinc-500
                    "
                  >
                    <span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span>
                    <span class="ml-3">November 28, 2024</span>
                  </time>

                  <h1
                    class="
                      mt-6 text-4xl font-bold tracking-tight text-emerald-700 dark:text-emerald-100
                      sm:text-5xl
                    "
                  >
                  Nobuild with Rails and Importmap
                  </h1>

                  <h3 class="text-2xl text-zinc-600 font-light tracking-tight mt-6 dark:text-zinc-100 sm:text-3xl">Learn how to use Importmap in Ruby on Rails to manage JavaScript dependencies without bundling. Covers web standards, Rails integration, gems compatibility, and suggested practices.</h3>
                </header>

                <!-- Article Content -->
                <div class="mt-8 prose prose-zinc dark:prose-invert">
                  <p>The latest versions of Ruby on Rails have focused on simplicity across different aspects of the framework, accompanied by the promise to return to the “one-man framework” (where a single developer can effectively build and maintain an entire application).</p>

<p>Importmap Rails library is based on the principle that modern web browsers have caught up with the ECMAScript specification and can interpret ES Modules (ESM). As a web standard, Importmap allows you to control how JavaScript modules are resolved in the browser and manage dependencies and versions without the need to transpile or bundle the code sent to the browser.</p>

<h2 id="how-the-importmap-web-standard-works">How the Importmap Web Standard Works</h2>

<p>It all starts with a <code class="highlighter-rouge">script</code> tag of type <code class="highlighter-rouge">importmap</code> defined in your application’s main layout or web page. Inside this tag, a JSON object defines aliases and their corresponding paths to the source code.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"importmap"</span><span class="nt">&gt;</span>
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">imports</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">application</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/assets/application.js</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">local-time</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://cdn.jsdelivr.net/npm/local-time@3.0.2/app/assets/javascripts/local-time.es2017-esm.min.js</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">utils</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/assets/utils.js</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>In the same map, you can mix library paths pointing to a CDN or using local resources. To use libraries from this map, reference the alias name.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--</span> <span class="nx">Below</span> <span class="nx">the</span> <span class="nx">importmap</span> <span class="nx">script</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">module</span><span class="dl">"</span><span class="o">&gt;</span><span class="k">import</span> <span class="dl">"</span><span class="s2">application</span><span class="dl">"</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p>And in your <em>application.js</em>, import needed dependencies:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// application.js</span>

<span class="k">import</span> <span class="nx">LocalTime</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">local-time</span><span class="dl">"</span><span class="p">;</span>
<span class="nx">LocalTime</span><span class="p">.</span><span class="nf">start</span><span class="p">();</span>

<span class="k">import</span> <span class="dl">"</span><span class="s2">utils</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div></div>

<p>Importmap support is present in browsers Chrome 89+, Safari 16.4+, Firefox 108+, and Edge 89+. For older browsers, include a polyfill:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script
  </span><span class="na">async</span>
  <span class="na">src=</span><span class="s">"https://ga.jspm.io/npm:es-module-shims@1.10.1/dist/es-module-shims.js"</span>
<span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<h2 id="how-importmap-works-in-ruby-on-rails">How Importmap Works in Ruby on Rails</h2>

<p>Importmap functionality in Ruby on Rails follows the same standard described above and offers an easy way to create maps and version files. Using a web application named <strong>heroImage</strong> as an example (source code available on <a href="https://github.com/mariochavez/inspiration">Github</a>), let’s explore the implementation.</p>

<p><img src="/images/no-build-importmap/heroimage-home.png" alt="heroImage website" /></p>

<p>When you create a new Rails 8 application, the <strong>importmap-rails</strong> gem is added and installed by default. A file <em>config/importmap.rb</em> is created where you can <em>pin</em> the JavaScript code needed in your application.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pin</span> <span class="s2">"application"</span>

<span class="n">pin</span> <span class="s2">"@hotwired/turbo-rails"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"turbo.min.js"</span>
<span class="n">pin</span> <span class="s2">"@hotwired/stimulus"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"stimulus.min.js"</span>
<span class="n">pin</span> <span class="s2">"@hotwired/stimulus-loading"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"stimulus-loading.js"</span>

<span class="n">pin_all_from</span> <span class="s2">"app/javascript/controllers"</span><span class="p">,</span> <span class="ss">under: </span><span class="s2">"controllers"</span><span class="p">,</span> <span class="ss">preload: </span><span class="kp">false</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">pin</code> keyword takes up to three arguments. The first one is required, as it is the alias of the JavaScript code. <code class="highlighter-rouge">pin "application"</code> is a shortcut for file <em>application.js</em> with alias <em>application</em>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pin</span> <span class="s2">"application"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"application.js"</span>
</code></pre></div></div>

<p>When alias and file names differ, use the keyword <code class="highlighter-rouge">to:</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pin</span> <span class="s2">"@hotwired/turbo-rails"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"turbo.min.js"</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">pin_all_from</code> keyword helps reference multiple files at once. The first argument is the path where the JavaScript files are located, and the <code class="highlighter-rouge">under:</code> argument prefixes the alias for each file. The generated alias uses the <em>under</em> prefix and the file name, like <code class="highlighter-rouge">controllers/alert-controller</code> for <code class="highlighter-rouge">alert_controller.js</code> file.</p>

<p>To visualize the Importmap JSON file, execute:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bin/importmap json

<span class="o">{</span>
  <span class="s2">"imports"</span>: <span class="o">{</span>
    <span class="s2">"@hotwired/turbo-rails"</span>: <span class="s2">"//127.0.0.1:4700/assets/turbo.min-fae85750.js"</span>,
    <span class="s2">"@hotwired/stimulus"</span>: <span class="s2">"//127.0.0.1:4700/assets/stimulus.min-4b1e420e.js"</span>,
    <span class="s2">"@hotwired/stimulus-loading"</span>: <span class="s2">"//127.0.0.1:4700/assets/stimulus-loading-1fc53fe7.js"</span>,
    <span class="s2">"application"</span>: <span class="s2">"//127.0.0.1:4700/assets/application-b1902c45.js"</span>,
    <span class="s2">"controllers/application"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/application-fab0f35b.js"</span>,
    <span class="s2">"controllers"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/index-c3f5d3c4.js"</span>,
    <span class="s2">"controllers/alert_controller"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/alert_controller-caf203bf.js"</span>,
    <span class="s2">"controllers/file_controller"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/file_controller-5da5fdc5.js"</span>,
    <span class="s2">"controllers/notifications_controller"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/notifications_controller-88e2cc65.js"</span>,
    <span class="s2">"controllers/service_worker_controller"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/service_worker_controller-ad4a24d3.js"</span>,
    <span class="s2">"controllers/share_controller"</span>: <span class="s2">"//127.0.0.1:4700/assets/controllers/share_controller-fe28ed00.js"</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Rails resolves all JavaScript through the <a href="https://github.com/rails/propshaft">Propshaft</a> gem, which resolves the physical path of the JavaScript code, maps to the <em>/assets</em> web path, and adds the digest to each file for better caching and invalidations.</p>

<p>Propshaft discovers physical paths from the asset’s configuration:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">paths</span>
</code></pre></div></div>

<p>Ensure your files exist in any of the registered paths or add your own path to be discovered by Propshaft and Importmap.</p>

<p>Importmap in Rails allows you to specify how the browser should load JavaScript files. There are two options: <code class="highlighter-rouge">preload</code> (default) and no preload. Preload tells the browser to download files as soon as possible. Importmap generates a link tag with <code class="highlighter-rouge">rel="modulepreload"</code>:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;link</span>
  <span class="na">rel=</span><span class="s">"modulepreload"</span>
  <span class="na">href=</span><span class="s">"https://heroimage.co/assets/turbo.min-fae85750.js"</span>
<span class="nt">/&gt;</span>
<span class="nt">&lt;link</span>
  <span class="na">rel=</span><span class="s">"modulepreload"</span>
  <span class="na">href=</span><span class="s">"https://heroimage.co/assets/stimulus-loading-1fc53fe7.js"</span>
<span class="nt">/&gt;</span>
<span class="nt">&lt;link</span>
  <span class="na">rel=</span><span class="s">"modulepreload"</span>
  <span class="na">href=</span><span class="s">"https://heroimage.co/assets/stimulus-loading-1fc53fe7.js"</span>
<span class="nt">/&gt;</span>
<span class="nt">&lt;link</span>
  <span class="na">rel=</span><span class="s">"modulepreload"</span>
  <span class="na">href=</span><span class="s">"https://heroimage.co/assets/application-b1902c45.js"</span>
<span class="nt">/&gt;</span>
</code></pre></div></div>

<p>If you set the <code class="highlighter-rouge">preload</code> argument to <code class="highlighter-rouge">false</code>, the link tag is not generated and the browser downloads the file when needed.</p>

<p>With Rails’ Importmap, you can also <em>pin</em> JavaScript code from a CDN using the <code class="highlighter-rouge">to:</code> argument for the URL:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pin</span> <span class="s2">"local-time"</span><span class="p">,</span> <span class="ss">to: </span><span class="s2">"https://cdn.jsdelivr.net/npm/local-time@3.0.2/app/assets/javascripts/local-time.es2017-esm.min.js"</span>
</code></pre></div></div>

<p>The Importmap includes a CLI to <strong>pin</strong> or <strong>unpin</strong> JavaScript code into <em>config/importmap.rb</em> file. It also includes commands to update, audit, and inspect versions:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bin/importmap <span class="nt">--help</span>
Commands:
  importmap audit              <span class="c"># Run a security audit</span>
  importmap <span class="nb">help</span> <span class="o">[</span>COMMAND]     <span class="c"># Describe available commands or one specific command</span>
  importmap json               <span class="c"># Show the full importmap in json</span>
  importmap outdated           <span class="c"># Check for outdated packages</span>
  importmap packages           <span class="c"># Print out packages with version numbers</span>
  importmap pin <span class="o">[</span><span class="k">*</span>PACKAGES]    <span class="c"># Pin new packages</span>
  importmap unpin <span class="o">[</span><span class="k">*</span>PACKAGES]  <span class="c"># Unpin existing packages</span>
  importmap update             <span class="c"># Update outdated package pins</span>
</code></pre></div></div>

<p>When using the <em>pin</em> command for a JavaScript package, instead of setting the <code class="highlighter-rouge">to:</code> argument to the CDN, Importmap resolves package dependencies and downloads the package and dependencies to <em>vendor/javascript</em>, allowing the Rails application to serve those files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bin/importmap pin local-time
Pinning <span class="s2">"local-time"</span> to vendor/javascript/local-time.js via download from https://ga.jspm.io/npm:local-time@3.0.2/app/assets/javascripts/local-time.es2017-esm.js
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/importmap.rb</span>
<span class="o">...</span>
<span class="n">pin</span> <span class="s2">"local-time"</span> <span class="c1"># @3.0.2</span>
</code></pre></div></div>

<p>This approach works well when your package has simple dependencies or well-defined dependencies in the JavaScript package. If that’s not the case, it becomes challenging to use with Importmap vendoring the code at <em>vendor/javascript</em>. It might work with the URL and manual dependency addition, or you can <a href="https://mariochavez.io/desarrollo/2024/08/09/no-build-javascript-rails-importmap/">tweak the vendored code</a> to make it work.</p>

<h2 id="how-to-work-with-rails-gems---engines---and-importmap">How to Work with Rails Gems - Engines - and Importmap?</h2>

<p>There are two approaches to creating Ruby on Rails gems compatible with Importmap. The first approach allows your gem to provide JavaScript code, which you can choose to pin in the Importmap configuration. This is how the <strong>turbo-rails</strong> and <strong>stimulus-rails</strong> gems are implemented.</p>

<p>Place your JavaScript code in the <em>app/assets/javascripts</em> folder of your gem. You may need an additional process that minifies the JavaScript files and generates JavaScript map files. Then, inside the <code class="highlighter-rouge">Engine</code> class, define an <code class="highlighter-rouge">initializer</code> hook to declare your JavaScript code with Propshaft:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">module</span> <span class="nn">MyEngine</span>
  <span class="k">class</span> <span class="nc">Engine</span> <span class="o">&lt;</span> <span class="o">::</span><span class="no">Rails</span><span class="o">::</span><span class="no">Engine</span>
    <span class="c1"># Additional code</span>
    <span class="no">PRECOMPILE_ASSETS</span> <span class="o">=</span> <span class="sx">%w( my_javascript.js my_javascript.min.js my_javascript.min.js.map )</span><span class="p">.</span><span class="nf">freeze</span>

    <span class="n">initializer</span> <span class="s2">"my_engine.assets"</span> <span class="k">do</span>
      <span class="k">if</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">respond_to?</span><span class="p">(</span><span class="ss">:assets</span><span class="p">)</span>
        <span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">precompile</span> <span class="o">+=</span> <span class="no">PRECOMPILE_ASSETS</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The second option uses an Importmap configuration file. If your engine has its layout template and the views are isolated from the host application, and the engine doesn’t need to share the JavaScript code with the host application, you can create an Importmap configuration file at <em>config/importmap.rb</em>, set your pins, place your JavaScript code at <em>app/javascript</em>, and configure the engine with an initializer.</p>

<p>Open your <code class="highlighter-rouge">engine.rb</code> Ruby file and add the Importmap configuration file and a sweeper:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">initializer</span> <span class="s2">"my-engine.importmap"</span><span class="p">,</span> <span class="ss">after: </span><span class="s2">"importmap"</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="no">MyEngine</span><span class="p">.</span><span class="nf">importmap</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span><span class="n">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">"config/importmap.rb"</span><span class="p">))</span>
  <span class="no">MyEngine</span><span class="p">.</span><span class="nf">importmap</span><span class="p">.</span><span class="nf">cache_sweeper</span><span class="p">(</span><span class="ss">watches: </span><span class="n">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">"app/javascript"</span><span class="p">))</span>

  <span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:action_controller_base</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">before_action</span> <span class="p">{</span> <span class="no">MyEngine</span><span class="p">.</span><span class="nf">importmap</span><span class="p">.</span><span class="nf">cache_sweeper</span><span class="p">.</span><span class="nf">execute_if_updated</span> <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Specify the Importmap to use in your engine’s layout template:</p>

<div class="language-erb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;%=</span> <span class="n">javascript_importmap_tags</span> <span class="s2">"application"</span><span class="p">,</span> <span class="ss">importmap: </span><span class="no">MyEngine</span><span class="p">.</span><span class="nf">importmap</span> <span class="cp">%&gt;</span>
</code></pre></div></div>

<p>For sharing JavaScript code with the host application, like Stimulus controllers, create a partial Importmap configuration file and set the engine to merge it with the main one in the host application.</p>

<p>Create an Importmap configuration file at <em>config/importmap.rb</em> and add the JavaScript pins to share with the host application. If you have dependencies for external packages, add those via a generator or installer to the host application:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pin_all_from</span> <span class="no">File</span><span class="p">.</span><span class="nf">expand_path</span><span class="p">(</span><span class="s2">"../app/assets/javascripts/controllers"</span><span class="p">,</span> <span class="n">__dir__</span><span class="p">),</span> <span class="ss">under: </span><span class="s2">"controllers"</span><span class="p">,</span> <span class="ss">preload: </span><span class="kp">false</span>
</code></pre></div></div>

<p>Open your <code class="highlighter-rouge">engine.rb</code> file and add an initializer:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">initializer</span> <span class="s2">"maquina.importmap"</span><span class="p">,</span> <span class="ss">before: </span><span class="s2">"importmap"</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="n">app</span><span class="p">.</span><span class="nf">config</span><span class="p">.</span><span class="nf">importmap</span><span class="p">.</span><span class="nf">paths</span> <span class="o">&lt;&lt;</span> <span class="no">Engine</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s2">"config/importmap.rb"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="what-are-the-advantages-of-using-importmap">What are the Advantages of Using Importmap?</h2>

<p>From a Ruby on Rails developer perspective, the main advantage of using Importmap is the freedom from requiring a JavaScript runtime-like node and freedom from the <em>node_modules</em> dependency.</p>

<p>Additionally, you don’t need an additional process in development mode to transpile and minify the JavaScript code. You rely on web standards to serve the code to the browser. Deploying your Rails application behind a reverse proxy offers several benefits. First, if you enable the HTTP/2 protocol, your browser can fetch multiple files with a single HTTP connection, and downloading many small JavaScript files won’t impact performance.</p>

<p><img src="/images/no-build-importmap/tools.png" alt="Web tools" /></p>

<p>Enabling your proxy to use gzip or brotli compression ensures you are sending very small files while maintaining readability when using browser developer tools. If you change one file, you only need to invalidate that specific file, which the browser will download. The browser knows that a file was modified because of the fingerprint that Propshaft adds to all files.</p>

<p>Using a reverse proxy like <a href="https://github.com/basecamp/thruster">Thruster</a> along with Puma offloads the assets serving from the Rails application. Thruster can cache assets and serve them when a client requests a file.</p>

<h2 id="when-not-to-use-importmap">When Not to Use Importmap</h2>

<p>There are cases where you should avoid using Importmap in a Rails application. If you are building a SPA application with React, Vue, or any other similar tool, there is a high likelihood you are writing your code with TypeScript. In this case, you should stick with the bundling strategy.</p>

<p>Additionally, if you need to support older browsers, bundling with code transpilation is a better option.</p>

                </div>
              </article>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>


      <!-- Footer -->
<footer class="mt-32 flex-none">
  <div class="sm:px-8">
    <div class="mx-auto w-full max-w-7xl lg:px-8">
      <div class="border-t border-zinc-100 pb-16 pt-10 dark:border-zinc-700/40">
        <div class="relative px-4 sm:px-8 lg:px-12">
          <div class="mx-auto max-w-2xl lg:max-w-5xl">
            <div class="flex flex-col items-center justify-between gap-6 sm:flex-row">
              <div
                class="
                  flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800
                  dark:text-zinc-200
                "
              >
              
                <a
                    href="/about"
                  class="
                    transition hover:text-emerald-500
                    dark:hover:text-emerald-400
                  "
                >
                About
                </a>
              
                <a
                    href="/articles"
                  class="
                    transition hover:text-emerald-500
                    dark:hover:text-emerald-400
                  "
                >
                Articles
                </a>
              
                <a
                    href="/projects"
                  class="
                    transition hover:text-emerald-500
                    dark:hover:text-emerald-400
                  "
                >
                Projects
                </a>
              
              </div>

              <p class="text-sm text-zinc-400 dark:text-zinc-500">
              &copy; 2025 Mario Alberto Chávez. All rights reserved.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

    </div>
  </body>
</html>
